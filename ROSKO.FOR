C
	PROGRAM FUEL
C
C	THIS PROGRAM SAVES THE AGGLOMERATOR 24 HOUR FUEL
C	CONSUMPTION LOG FOR REBIDDING.  IT IS TURNED ON BY THE
C	LOGSCH (LOG COLLAPSE AND SCHEDULER) PROGRAM.
C
C	COAL MBTUS FACTOR CHANGED PER COREY BIRD 04-21-2004
C	FROM 8.8 TO 12.1
C
C	COAL MBTUS FACTOR CHANGED PER COREY BIRD 05-03-2004
C	FROM 12.1 TO 11.3
C
C	COAL MBTUS FACTOR CHANGED PER COREY BIRD 06-02-2004
C	FROM 11.3 TO 8.8
C
C	CWOOD MBTUS FACTOR CHANGED PER RAY POTTS 10-11-2005
C	FROM 8.35 TO 7.608
C
C	COAL MBTUS FACTOR CHANGED PER SHAWN GULBRANSON 04-21-2006
C	FROM 8.8 TO 9.4 PRS #1823
C
	IMPLICIT NONE
C
	INCLUDE	'($PRCDEF)'
C
	INTEGER*4	LOGQUEX(2),BIT,
	1		I,J,K,L,N,M
	INTEGER*4	UFO_OPEN
C
	REAL*4		VALU(30),VAL(28),SPARE(59),
	1		ACCUM,OBS,SAVE(5),SAVEX,TOT(4)
	REAL*4		SMCF(12),OIL(5),WOOD(5),COAL(5),
	1		TONSG(5),TONSO(5),TONSW(5),TONSC(5),
	1		TEMP(7),PRESS(7),
	1		TSMCF,TOIL,TWOOD,TCOAL,
	1		TTONSG,TTONSO,TTONSW,TTONSC,
	1		TMBTUS,TTONS,TOTPHB,CTAILS,CRSGAS,CNCGAS
	REAL*4		FIVESEC/5.0/,MBTUS(5),PULSE
	REAL*4		VALUES(24)
	REAL*4		VALS(24,100)
C
	INTEGER*4	LIST(30)/1051,1041,537,1043,1052,1042,
	1			 538,1044,1040,1045,1046,
	1			 1047,1048,1049,1050,1070,894,1074,
	1			 853,1073,1071,1072,
	1			 154,153,270,269,332,333,823,822/
C
	CHARACTER*23	DATETIME
	CHARACTER*12	DATEXS/'            '/
	CHARACTER*12	DATXS(100)
	CHARACTER*11	TRAINS/'OREM:TRAINS'/
C
	CHARACTER*16	ERRX/'LOGS:STRENDX.ERR'/	!ERROR FILE
	CHARACTER*9	BTUM/'OREM:BTUM'/
	CHARACTER*12	STRENDX/'LOGS:STRENDX'/
	CHARACTER*9	PROC/'MET_P:WJB'/
	CHARACTER*10	PROCX/'MET_P:WJBX'/
	CHARACTER*12	DATEX,DATX
	CHARACTER*14	FILE(4)/'LOGS:HOUR.DAT ',
	1		        'LOGS:SHIFT.DAT',
	1		        'LOGS:DAY.DAT  ',
	1		        'LOGS:MONTH.DAT'/
C
	CHARACTER*18	UTLFILE(4)/'LOGS:UTL_HOUR.DAT ',
	1			   'LOGS:UTL_SHIFT.DAT',
	1			   'LOGS:UTL_DAY.DAT  ',
	1			   'LOGS:UTL_MONTH.DAT'/
C
	CHARACTER*18	AG3FILE(4)/'LOGS:AG3_HOUR.DAT ',
	1			   'LOGS:AG3_SHIFT.DAT',
	1			   'LOGS:AG3_DAY.DAT  ',
	1			   'LOGS:AG3_MONTH.DAT'/
C
	CHARACTER*18	CRSFILE(4)/'LOGS:CRS_HOUR.DAT ',
	1			   'LOGS:CRS_SHIFT.DAT',
	1			   'LOGS:CRS_DAY.DAT  ',
	1			   'LOGS:CRS_MONTH.DAT'/
C
	CHARACTER*6	TITLE(4)/'HOUR  ',
	1			 'SHIFT ',
	1			 'DAY   ',
	1			 'MONTH '/
C
	EXTERNAL	UFO_OPEN
C
	COMMON/LOGQUE/LOGQUEX
C
	IF (LOGQUEX(1) .EQ. 0)GOTO 9999	!IF NO WORK SHUT OFF
C
210	CONTINUE
C
	CALL	LIB$DATE_TIME(DATETIME)	!GET TIME AND DATE
	DATEX(1:11)=DATETIME(1:11)
C
	DO 5000	I=2,3		!SHIFT AND DAILY LOG DATA
		N=(I-1)*22
		BIT=JIBITS(LOGQUEX(1),I-1,1)
		IF (BIT .EQ. 0)GOTO 5000
C
		OPEN(UNIT=1,NAME=FILE(I),FORM='UNFORMATTED',
	1		ACCESS='DIRECT',STATUS='OLD',RECL=2,SHARED,
	1		CARRIAGECONTROL='FORTRAN',RECORDTYPE='FIXED',
	1		USEROPEN=UFO_OPEN)
C
		OPEN(UNIT=4,NAME=UTLFILE(I),FORM='UNFORMATTED',
	1		ACCESS='DIRECT',STATUS='OLD',RECL=2,SHARED,
	1		CARRIAGECONTROL='FORTRAN',RECORDTYPE='FIXED',
	1		USEROPEN=UFO_OPEN)
C
		OPEN(UNIT=2,NAME=CRSFILE(I),FORM='UNFORMATTED',
	1		ACCESS='DIRECT',STATUS='OLD',RECL=2,SHARED,
	1		CARRIAGECONTROL='FORTRAN',RECORDTYPE='FIXED',
	1		USEROPEN=UFO_OPEN)
C
		IF (I .EQ. 2)THEN	!IF THIS IS SHIFT RUN
			IF (DATETIME(13:14) .EQ. '06')DATEX(12:12)='1'
			IF (DATETIME(13:14) .EQ. '14')DATEX(12:12)='2'
			IF (DATETIME(13:14) .EQ. '22')DATEX(12:12)='3'
		END IF
C
		IF (I .EQ. 3)DATEX(12:12)='3'	!IF THIS IS 24HR RUN
C
		DO 500 J=1,30		!READ IN ALL STEP II DATA
			READ	(1,REC=LIST(J))ACCUM,OBS
			IF (J .GT. 22) THEN
				IF (OBS .EQ. 0)THEN
					VALU(J)=0
				ELSE
					VALU(J)=ACCUM/OBS
				END IF
			ELSE
				VALU(J)=ACCUM
			END IF
500		CONTINUE
C
		READ	(1,REC=951)PULSE,OBS 	!READ IN TURBINE PULSE
C
		SMCF(1)=VALU(16)	!LINE 3 GAS
		TONSG(1)=VALU(18)	!LINE 3 GAS TONS
		OIL(1)=VALU(19)		!LINE 3 OIL
		TONSO(1)=VALU(20)	!LINE 3 OIL TONS
		WOOD(1)=VALU(21)/2000		!LINE 3 WOOD
		TONSW(1)=VALU(22)		!LINE 3 TONS FROM WOOD
		COAL(1)=0		!NO COAL LINE 3
		TONSC(1)=0		!NO COAL TONS LINE 3
		TEMP(1)=VALU(29)	!LINE 3 GAS TEMP
		PRESS(1)=VALU(30)	!LINE 3 GAS PRESS
C
		SMCF(2)=VALU(1)		!LINE 4 GAS
		TONSG(2)=VALU(2)	!LINE 4 GAS TONS
		OIL(2)=VALU(3)		!LINE 4 OIL
		TONSO(2)=VALU(4)	!LINE 4 OIL TONS
		WOOD(2)=VALU(12)/2000		!LINE 4 WOOD
		TONSW(2)=VALU(14)		!LINE 4 TONS FROM WOOD
		COAL(2)=0		!NO COAL LINE 4
		TONSC(2)=0		!NO COAL TONS LINE 4
		TEMP(2)=VALU(23)	!LINE 4 GAS TEMP
		PRESS(2)=VALU(24)	!LINE 4 GAS PRESS
C
		SMCF(3)=VALU(5)		!LINE 5 GAS
		TONSG(3)=VALU(6)	!LINE 5 GAS TONS
		OIL(3)=VALU(7)		!LINE 5 OIL
		TONSO(3)=VALU(8)	!LINE 5 OIL TONS
		WOOD(3)=VALU(13)/2000		!LINE 5 WOOD
		TONSW(3)=VALU(15)		!LINE 5 TONS FROM WOOD
		COAL(3)=0		!NO COAL LINE 5
		TONSC(3)=0		!NO COAL TONS LINE 5
		TEMP(3)=VALU(25)	!LINE 5 GAS TEMP
		PRESS(3)=VALU(26)	!LINE 5 GAS PRESS
		SMCF(7)=VALU(9)		!TURBINE GAS
		TEMP(7)=VALU(27)	!TURBINE TEMP
		PRESS(7)=VALU(28)	!TURBINE PRESS
		SMCF(8)=VALU(17)	!LINE 3 PH BURNER GAS
		SMCF(9)=VALU(10)	!LINE 4 PH BURNER GAS
		SMCF(10)=VALU(11)	!LINE 5 PH BURNER GAS
C
C
C	READ IN ALL UTILITIES POINTS
C
		READ	(4,REC=240)SMCF(6),OBS		!UTILITIES MAIN GAS
		VAL(17)=SMCF(6)
		READ	(4,REC=145)ACCUM,OBS		!UTILITIES TEMP
		IF (OBS .EQ. 0)THEN
			TEMP(6)=0
		ELSE
			TEMP(6)=ACCUM/OBS
		END IF
		VAL(18)=TEMP(6)
		READ	(4,REC=144)ACCUM,OBS		!UTILITIES PRESS
		IF (OBS .EQ. 0)THEN
			PRESS(6)=0
		ELSE
			PRESS(6)=ACCUM/OBS
		END IF
		VAL(19)=PRESS(6)
		READ	(4,REC=241)CTAILS,OBS 		!COARSE TAILS GAS
		VAL(22)=CTAILS
C
		READ	(4,REC=251)CNCGAS,OBS 		!CONCENTRATOR GAS
		VAL(28)=CNCGAS
C
		READ	(2,REC=493)CRSGAS,OBS 		!CRUSHER GAS
		CRSGAS=CRSGAS/1000			!CONVERT TO SMCF
		VAL(23)=CRSGAS
C
C	READ IN ALL STEP III DATA
C
		OPEN(UNIT=5,NAME=AG3FILE(I),FORM='UNFORMATTED',
	1		ACCESS='DIRECT',STATUS='OLD',RECL=2,SHARED,
	1		CARRIAGECONTROL='FORTRAN',RECORDTYPE='FIXED',
	1		USEROPEN=UFO_OPEN)
C
		READ	(5,REC=862)SMCF(4),OBS		!LINE 6 GAS
		VAL(1)=SMCF(4)
		READ	(5,REC=864)TONSG(4),OBS		!LINE 6 GAS TONS
		VAL(2)=TONSG(4)
		READ	(5,REC=522)OIL(4),OBS		!LINE 6 OIL
		VAL(3)=OIL(4)
		READ	(5,REC=868)TONSO(4),OBS		!LINE 6 OIL TONS
		VAL(4)=TONSO(4)
		READ	(5,REC=521)COAL(4),OBS		!LINE 6 COAL LBS 
		VAL(5)=COAL(4)/2000			!CONVERT TO TONS
		COAL(4)=COAL(4)/2000
		READ	(5,REC=866)TONSC(4),OBS		!LINE 6 COAL TONS
		VAL(6)=TONSC(4)
		READ	(5,REC=911)WOOD(4),OBS		!LINE 6 WOOD LBS 
		WOOD(4)=WOOD(4)/2000                    !CONVERT TO TONS
		VAL(24)=WOOD(4)
		READ	(5,REC=913)TONSW(4),OBS		!LINE 6 WOOD TONS
		VAL(25)=TONSW(4)
		READ	(5,REC=115)ACCUM,OBS		!LINE 6 GAS TEMP
		IF (OBS .EQ. 0)THEN
			TEMP(4)=0
		ELSE
			TEMP(4)=ACCUM/OBS
		END IF
		VAL(7)=TEMP(4)
		READ	(5,REC=116)ACCUM,OBS		!LINE 6 GAS PRESS
		IF (OBS .EQ. 0)THEN
			PRESS(4)=0
		ELSE
			PRESS(4)=ACCUM/OBS
		END IF
		VAL(8)=PRESS(4)
		READ	(5,REC=525)SMCF(11),OBS		!LINE 6 PHB GAS
		VAL(20)=SMCF(11)
C
		READ	(5,REC=863)SMCF(5),OBS	!LINE 7 GAS
		VAL(9)=SMCF(5)
		READ	(5,REC=865)TONSG(5),OBS	!LINE 7 GAS TONS
		VAL(10)=TONSG(5)
		READ	(5,REC=547)OIL(5),OBS	!LINE 7 OIL
		VAL(11)=OIL(5)
		READ	(5,REC=869)TONSO(5),OBS	!LINE 7 OIL TONS
		VAL(12)=TONSO(5)
		READ	(5,REC=546)COAL(5),OBS	!LINE 7 COAL LBS
		VAL(13)=COAL(5)/2000		!CONVERT TO TONS
		COAL(5)=COAL(5)/2000
		READ	(5,REC=867)TONSC(5),OBS	!LINE 7 COAL TONS
		VAL(14)=TONSC(5)
		READ	(5,REC=912)WOOD(5),OBS		!LINE 7 WOOD LBS 
		WOOD(5)=WOOD(5)/2000                    !CONVERT TO TONS
		VAL(26)=WOOD(5)
		READ	(5,REC=914)TONSW(5),OBS		!LINE 7 WOOD TONS
		VAL(27)=TONSW(5)
		READ	(5,REC=283)ACCUM,OBS	!LINE 7 GAS TEMP
		IF (OBS .EQ. 0)THEN
			TEMP(5)=0
		ELSE
			TEMP(5)=ACCUM/OBS
		END IF
		VAL(15)=TEMP(5)
		READ	(5,REC=284)ACCUM,OBS	!LINE 7 GAS PRESS
		IF (OBS .EQ. 0)THEN
			PRESS(5)=0
		ELSE
			PRESS(5)=ACCUM/OBS
		END IF
		VAL(16)=PRESS(5)
		READ	(5,REC=549)SMCF(12),OBS	!LINE 7 PHB GAS
		VAL(21)=SMCF(12)
C
		TOTPHB=0
		TMBTUS=0
		TTONS=0
		TSMCF=0
		TOIL=0
		TWOOD=0
		TCOAL=0
		TTONSG=0
		TTONSO=0
		TTONSW=0
		TTONSC=0
C
		TOT(1)=0
		TOT(2)=0
		TOT(3)=0
		TOT(4)=0
C
		DO 800 J=1,5
			IF (TONSG(J) .EQ. 0)THEN
				SAVE(1)=0
			ELSE
				SAVE(1)=(SMCF(J)*1000)/TONSG(J)
			END IF
C
			IF (TONSC(J) .EQ. 0)THEN
				SAVE(2)=0
			ELSE
C				SAVE(2)=(COAL(J)*13.9*2000)/TONSC(J)
C				SAVE(2)=(COAL(J)*9.350*2000)/TONSC(J)
C				SAVE(2)=(COAL(J)*8.800*2000)/TONSC(J)
C				SAVE(2)=(COAL(J)*12.10*2000)/TONSC(J)
C				SAVE(2)=(COAL(J)*11.30*2000)/TONSC(J)
C				SAVE(2)=(COAL(J)*8.800*2000)/TONSC(J)
				SAVE(2)=(COAL(J)*9.400*2000)/TONSC(J)
			END IF
C
			IF (TONSO(J) .EQ. 0)THEN
				SAVE(3)=0
			ELSE
				SAVE(3)=(OIL(J)*139)/TONSO(J)
			END IF
C
			IF (TONSW(J) .EQ. 0)THEN
				SAVE(4)=0
			ELSE
C				SAVE(4)=(WOOD(J)*8.585*2000)/TONSW(J)
C				SAVE(4)=(WOOD(J)*8.35*2000)/TONSW(J)
				SAVE(4)=(WOOD(J)*7.608*2000)/TONSW(J)
			END IF
C
C			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*13.9*2000)+
C	1			(OIL(J)*139)+(WOOD(J)*8.585*2000)
C			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*9.350*2000)+
C	1			(OIL(J)*139)+(WOOD(J)*8.585*2000)
C			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*8.800*2000)+
C	1			(OIL(J)*139)+(WOOD(J)*8.35*2000)
C			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*12.10*2000)+
C	1			(OIL(J)*139)+(WOOD(J)*8.35*2000)
C			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*11.30*2000)+
C	1			(OIL(J)*139)+(WOOD(J)*8.35*2000)
C			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*8.800*2000)+
C	1			(OIL(J)*139)+(WOOD(J)*8.35*2000)
C			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*8.800*2000)+
C	1			(OIL(J)*139)+(WOOD(J)*7.608*2000)
			SAVE(5)=(SMCF(J)*1000)+(COAL(J)*9.400*2000)+
	1			(OIL(J)*139)+(WOOD(J)*7.608*2000)
C
			SAVEX=TONSG(J)+TONSC(J)+TONSO(J)+TONSW(J)
C
			TMBTUS=TMBTUS+SAVE(5)
			TTONS=TTONS+SAVEX
C
			IF (SAVEX .EQ. 0)THEN
				SAVE(5)=0
			ELSE
				SAVE(5)=SAVE(5)/SAVEX
			END IF
C
		IF (I .EQ. 2)MBTUS(J)=SAVE(5)	!SAVE LINE TOTAL MBTUS
		IF (I .EQ. 3)MBTUS(J)=SAVE(5)	!SAVE LINE TOTAL MBTUS
C
		TSMCF=TSMCF+SMCF(J)*1000
		TOIL=TOIL+OIL(J)*139
C		TCOAL=TCOAL+COAL(J)*13.9*2000
C		TCOAL=TCOAL+COAL(J)*9.350*2000
C		TCOAL=TCOAL+COAL(J)*8.800*2000
C		TCOAL=TCOAL+COAL(J)*12.10*2000
C		TCOAL=TCOAL+COAL(J)*11.30*2000
C		TCOAL=TCOAL+COAL(J)*8.800*2000
		TCOAL=TCOAL+COAL(J)*9.400*2000
C		TWOOD=TWOOD+WOOD(J)*8.585*2000
C		TWOOD=TWOOD+WOOD(J)*8.35*2000
		TWOOD=TWOOD+WOOD(J)*7.608*2000
C
		TTONSG=TTONSG+TONSG(J)
		TTONSO=TTONSO+TONSO(J)
		TTONSW=TTONSW+TONSW(J)
		TTONSC=TTONSC+TONSC(J)
C
800		CONTINUE
C
840		CONTINUE
C
		DO 900 J=1,5
			TOT(1)=TOT(1)+SMCF(J)
			TOT(2)=TOT(2)+COAL(J)
			TOT(3)=TOT(3)+OIL(J)
			TOT(4)=TOT(4)+WOOD(J)
900		CONTINUE
C
		TOT(1)=TOT(1)+SMCF(6)+CTAILS+CRSGAS	!ADD UTIL,CTAILS,CRSGAS
C
		IF (TTONSG .EQ. 0)THEN
			SAVE(1)=0
		ELSE
			SAVE(1)=TSMCF/TTONSG
		END IF
C
		IF (TTONSC .EQ. 0)THEN
			SAVE(2)=0
		ELSE
			SAVE(2)=TCOAL/TTONSC
		END IF
C
		IF (TTONSO .EQ. 0)THEN
			SAVE(3)=0
		ELSE
			SAVE(3)=TOIL/TTONSO
		END IF
C
		IF (TTONSW .EQ. 0)THEN
			SAVE(4)=0
		ELSE
			SAVE(4)=TWOOD/TTONSW
		END IF
C
		IF (TTONS .EQ. 0)THEN
			SAVE(5)=0
		ELSE
			SAVE(5)=TMBTUS/TTONS
		END IF
C
		TOTPHB=SMCF(8)+SMCF(9)+SMCF(10)+SMCF(11)+SMCF(12)
C
960		CONTINUE
C
1000		CONTINUE
		CLOSE	(UNIT=1)
		CLOSE	(UNIT=2)
		CLOSE	(UNIT=3)
		CLOSE	(UNIT=4)
		CLOSE	(UNIT=5)
		CALL	LIB$WAIT(FIVESEC)
C
		IF (I .EQ. 2)THEN	!IF THIS IS SHIFT RUN
C
			OPEN	(UNIT=5,FILE='LOGS:MBTUS.DAT',STATUS='OLD',
	1			RECL=8,RECORDTYPE='FIXED',FORM='UNFORMATTED',
	1			SHARED,USEROPEN=UFO_OPEN,ACCESS='DIRECT')
C
			WRITE	(5,REC=1)DATEX,MBTUS	!SAVE DATA FOR MAKI
C
			CLOSE	(UNIT=5)
C
		CALL	SYS$CREPRC(,BTUM,,,,,,BTUM,%VAL(4),,,
	1		%VAL(PRC$M_DETACH.OR.PRC$M_NOACNT))
C
		OPEN	(UNIT=1,FILE='LOGS:STREND.DAT',STATUS='OLD',
	1		 ACCESS='DIRECT',RECORDTYPE='FIXED',
	1	 	 FORM='UNFORMATTED',RECL=27,SHARED,USEROPEN=UFO_OPEN)
C
		DO 100	M=1,100
			READ	(1,REC=M)DATXS(M),(VALS(J,M),J=1,24)
100		CONTINUE
C
		CALL	LIB$DATE_TIME(DATETIME)	!GET TIME AND DATE
		DATEXS(1:11)=DATETIME(1:11)
		IF (DATETIME(13:14) .EQ. '06')DATEXS(12:12)='1'
		IF (DATETIME(13:14) .EQ. '14')DATEXS(12:12)='2'
		IF (DATETIME(13:14) .EQ. '22')DATEXS(12:12)='3'
C		IF (DATEXS(12:12) .EQ. ' ')GOTO 99999 !IF NOT END OF SHIFT QUIT
C
		IF (DATEXS(12:12) .EQ. ' ')THEN	!CANNOT DECIDE WHICH SHIFT
			IF (DATXS(1)(12:12) .EQ. '1')DATEXS(12:12)='2'
			IF (DATXS(1)(12:12) .EQ. '2')DATEXS(12:12)='3'
			IF (DATXS(1)(12:12) .EQ. '3')DATEXS(12:12)='1'
		END IF
C
		IF (DATEXS .EQ. DATXS(1))GOTO 99999 !IF SHIFT ALREADY BUILT QUIT
C
		WRITE	(1,REC=1)DATEXS,VALUES !INSERT NEW SHIFT AT TOP OF FILE
C
		DO 200	M=1,99
			WRITE	(1,REC=M+1)DATXS(M),(VALS(J,M),J=1,24)
200		CONTINUE
C
99999		CONTINUE
C
		CLOSE	(UNIT=1)
C
C		CALL	SYS$CREPRC(,TRAINS,,,,,,TRAINS,%VAL(4),,,
C	1		%VAL(PRC$M_DETACH.OR.PRC$M_NOACNT))
C
C		CALL	SYS$CREPRC(,STRENDX,,,ERRX,,,STRENDX,%VAL(4),,,
C	1		%VAL(PRC$M_DETACH.OR.PRC$M_NOACNT))
		END IF
C
		IF (I .EQ. 3)THEN	!IF THIS IS 24 HR  RUN
C
			OPEN	(UNIT=5,FILE='LOGS:MBTUS.DAT',STATUS='OLD',
	1			RECL=8,RECORDTYPE='FIXED',FORM='UNFORMATTED',
	1			SHARED,USEROPEN=UFO_OPEN,ACCESS='DIRECT')
C
			WRITE	(5,REC=2)DATEX,MBTUS	!SAVE DATA FOR MAKI
C
			CLOSE	(UNIT=5)
C
	OPEN	(UNIT=5,FILE='LOGS:FUELRB.DAT',STATUS='OLD',
	1	FORM='UNFORMATTED',RECL=62,ACCESS='DIRECT',
	1	RECORDTYPE='FIXED',SHARED,USEROPEN=UFO_OPEN)
C
	DO 1200	L=4,1,-1
C
		READ	(5,REC=L)DATX,SPARE	!SHUFFLE IN
		WRITE	(5,REC=L+1)DATX,SPARE	!NEW DAY
C
1200	CONTINUE
C
		WRITE	(5,REC=1)DATEX,VALU,VAL,PULSE	!NEW DAY
C
		CLOSE	(UNIT=5)
C
		CALL	SYS$CREPRC(,PROC,,,,,,PROC,%VAL(4),,,
	1		%VAL(PRC$M_DETACH.OR.PRC$M_NOACNT))
C
		CALL	LIB$WAIT(60.0)
C
		CALL	SYS$CREPRC(,PROCX,,,,,,PROCX,%VAL(4),,,
	1		%VAL(PRC$M_DETACH.OR.PRC$M_NOACNT))
		END IF
C
5000	CONTINUE
C
9999	CALL	EXIT
C
	END
