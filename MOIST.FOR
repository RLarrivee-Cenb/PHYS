C
	INTEGER UFO_OPEN
	EXTERNAL UFO_OPEN
C
C
	CHARACTER TWELV*1/12/,PUT*3,AINTV/'1'/,
	1	PO*3/'[5i'/,POF*3/'[4i'/,ES/27/,STR*4,STRL*4
C
ccccccccccccccccccccccccccccccccc
	INTEGER*4	DATETIME,LEN,WBILL,PLANT,CARS,NUM
	INTEGER*4	OCARS,UCARS,CUT1(6),CUT2(6) 
	INTEGER*4	CUT4(6),CARSX,SPLITC(2)
	INTEGER*4	NUMX,PLANTX,DESTX,CHECKN,CHECKNX
	INTEGER*4	FLUXL(16),FLUXH(16),ACIDL(16),ACIDH(16)
C
cccccccccccccccccccccccccccccccccc
C
C
	DOUBLE PRECISION SILL,MOIST,IRON,TONS,TTT(4),TTTX(4)
C
C
C
	DOUBLE PRECISION SX(23),SX2(23),MEAN(23),SMB1,SMA1,SMB2,SMA2,SD(23),
	1	MEANU(23)
C
	DOUBLE PRECISION MCC(150),OIC(150),NM(200),NY(200),TEMP,
	1	MCC3(150),OIC3(150),NM3(200),NY3(200)
C
	INTEGER N(23),MNTH,DAT(2),IS,IH,S4,H4,ENDB(2),DAYB(2)
C
	CHARACTER HSKEY*4,YR*4,KY*6,KD*6,enda*11,FILE*23,DAYX/'1'/,
	1		NTK*7,EK*7,SCEK*6,YR2*4
C
C
 	DOUBLE PRECISION SCREEN(14,3,2,5),COMP(2,3,2,5),
	1  CAB(2,3,5),SIL(3,5),FILT2(5,3),FILT3(5,3),BL2,BL3,
	1  FLUXG,FCA(2,3),FMG(2,3),FAL(2,3),FSI(2,3),
	1  PA(3,5),PC(3,5),PM(3,5),X
C
	CHARACTER MON(12)*3/'JAN','FEB','MAR','APR','MAY','JUN','JUL',
	1			'AUG','SEP','OCT','NOV','DEC'/
	structure /bozo2/
c
		character*4	key		! yymm	(primary key)
		real		msil(3,31)	! mine ind. sio2 by shift,day
		real		cr12(3,31)	! crusher +1/2 by shift,day
		real 		flfr(3,31)	! flf davis tube recovery
		real		flfs(3,31)	! flf davis tube sio2
		real		fls(3,31)	! flf sio2
		real		flts(3,31)	! flot tails sio2
		real		aeff(4,3,31)	! amine efficiency by cell
c
c
	end structure
c
	record /bozo2/ hsd
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
C
	STRUCTURE /X/
		CHARACTER 	KEY*7   	!STEP, YYMMDD
		REAL		POINTS(4,50)	! NOLA VALUES
		REAL		TARG(4,50)	! TARGET VALUES
		INTEGER		DATIM(2,4,50)	!binary time for each sample
		INTEGER		K		!daily entry count (1-50)
		INTEGER 	ME		! END OF MONTH INDICATOR
	END STRUCTURE
C
	RECORD /X/ NOL
C
C
C
	CHARACTER
	1	LABEL(23)*24/
	1	'MINE IND. SIO2          ',
	1	'CRUSHER % -1/2          ',
	1	'CONC FLOT FEED -270     ',
	1	'CONC STEP 2 NOLA VS TARG',
	1	'CONC STEP 3 NOLA VS TARG',
	1	'AGGLOM 2 PELLET B/A     ',
	1	'AGGLOM 2 % +1/2         ',
	1	'AGGLOM 2 BT %+1/4       ',
	1	'AGGLOM 2 AT %+1/4       ',
	1	'AGGLOM 2 COMPRESSION    ',
	1	'AGGLOM 2 LTB %+1/4      ',
	1	'AGGL T TRAIN %H2O SUMMER',
	1	'AGGL T TRAIN %H2O WINTER',
	1	'AGGLOM 3 PELLET B/A     ',
	1	'AGGLOM 3 % +1/2         ',
	1	'AGGLOM 3 BT %+1/4       ',
	1	'AGGLOM 3 AT %+1/4       ',
	1	'AGGLOM 3 COMPRESSION    ',
	1	'AGGLOM 3 LTB %+1/4      ',
	1	'AGGL 3 TRAIN %H2O SUMMER',
	1	'AGGL 3 TRAIN %H2O WINTER',
	1	'AGGLOM 2 REDUCIBILITY   ',
	1	'AGGLOM 3 REDUCIBILITY   '/,AAM*2
C
C
C
	CHARACTER INTV(23)*9/
	1	' SHIFT   ',
	1	' SHIFT   ',
	1	' SHIFT   ',
	1	' 1 HOUR  ',
	1	' 1 HOUR  ',
	1	' SHIFT   ',
	1	' 4 HOUR  ',
	1	' 4 HOUR  ',
	1	' 4 HOUR  ',
	1	' 4 HOUR  ',
	1	'WEEK COMP',
	1	' TRAIN   ',
	1	' TRAIN   ',
	1	' SHIFT   ',
	1	' 4 HOUR  ',
	1	' 4 HOUR  ',
	1	' 4 HOUR  ',
	1	' 4 HOUR  ',
	1	'WEEK COMP',
	1	' TRAIN   ',
	1	' TRAIN   ',
	1	'WEEK COMP',
	1	'WEEK COMP'/
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
	STR=ES//PO
	STRL=ES//POF
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
	WRITE (6,*) ' FLUX PELLET IN-HOUSE STANDARDS'
C
	WRITE (6,*) ' call R.J. MAKI AT 7490 to check that all acid pellet'
	WRITE (6,*) '  runs are being ignored before running this.'
	WRITE (6,*) ' '
	WRITE (6,*) ' WHAT YEAR  ex. 1992'
	READ (5,10) YR
C
10	FORMAT (A4)
C
	WRITE (6,*) ' '
	WRITE (6,*) ' '
	WRITE (6,*) ' THRU WHAT MONTH  ex. 1-12'
C
	READ (5,11) AAM
11	FORMAT (A)
C
	IF (AAM(2:2) .EQ. ' ') AAM=' '//AAM(1:1)
	READ (AAM,'(I2)')MNTH
C
		WRITE (6,229)STR
229		FORMAT (' ',A)
C
	OPEN (UNIT=91,FILE='MET_P:HALFSIL2.DAT',STATUS='OLD',
	1	ACCESS='KEYED',SHARED,ERR=88,READONLY)
C
C
C
	DO 100 IM=1,MNTH
C
C
	WRITE  (HSKEY(3:4),'(I2)') IM
	IF (HSKEY(3:3) .EQ. ' ') HSKEY(3:3)='0'
C
	HSKEY(1:2)=YR(3:4)
C
C
C
	READ (91,KEY=HSKEY,ERR=88) HSD
C
		DO 31 J=1,31
			DO 29 K=1,3
				IF (HSD.MSIL(K,J) .LE. 0) GO TO 29
				N(1)=N(1)+1
				SX(1)=SX(1)+HSD.MSIL(K,J)
				SX2(1)=SX2(1)+HSD.MSIL(K,J)**2
29			CONTINUE
C
			DO 30 K=1,3
				IF (HSD.CR12(K,J) .LE. 0) GO TO 30
				N(2)=N(2)+1
				SX(2)=SX(2)+HSD.CR12(K,J)
				SX2(2)=SX2(2)+HSD.CR12(K,J)**2
30			CONTINUE
C
C
31		CONTINUE
C
100	CONTINUE
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
88	IPASS=0
C
	LASTYEAR=0
C
	CALL SYS$BINTIM (DAYX,DAYB)
C
	ENDA(8:11)=YR
	i=mnth+1
	YR2=YR
	if (i .gt. 12) THEN
		I=1
		READ (YR,'(I4)') NNN
		NNN=NNN+1
		WRITE (YR2,'(I4)') NNN
		ENDA(8:11)=YR2
		LASTYEAR=1
	END IF
C
	ENDA(1:7)='01-'//MON(I)//'-'
c
	WRITE (SCEK(3:4),'(I2)') I
	IF (SCEK(3:3) .EQ. ' ') SCEK(3:3)='0'
	SCEK=YR2(3:4)//SCEK(3:4)//'01'
C
	OPEN (11,FILE='MET_P:SCREEN.DAT',FORM='UNFORMATTED',
	1	ACCESS='KEYED',STATUS='old',RECL=2500,ERR=2525,
	1	ORGANIZATION='INDEXED',KEY=(1:6:CHARACTER),shared,
	1	READONLY)
C
C
C
C
	IF (IPASS .EQ. 0) THEN
C
	IPASS=1
C
	KY=HSKEY(1:2)//'0101'
C
	NTK(2:7)=KY	! SAVE KEY FOR NOLTAR FILE
C
	READ (11,KEY=KY,ERR=2525) KD,DAT,IS,IH,SCREEN,COMP,CAB,SIL,FILT2,
	1			    FILT3,BL2,BL3,FLUXG,FCA,FMG,FAL,FSI,   
	1			    PA,PC,PM,S4,H4                            
C
	GO TO 44
C
	END IF
C
C
C
CCCCCCCCCCCC
C
C
C
111	READ (11,ERR=2525) KD,DAT,IS,IH,SCREEN,COMP,CAB,SIL,FILT2,
	1			    FILT3,BL2,BL3,FLUXG,FCA,FMG,FAL,FSI,   
	1			    PA,PC,PM,S4,H4                            
C
C
	IF (KD .GE. SCEK) GO TO 200
C
C
44	DO 400 IS=1,3
C
C
C
		IF (FSI(2,IS) .GT. 0) THEN   		!FL FEED -270
		SX(3)=SX(3)+FSI(2,IS)
		SX2(3)=SX2(3)+FSI(2,IS)**2
		N(3)=N(3)+1
		END IF
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
C
c	   ignore step 2 acid pellet data
c
	if (kd .ge. '920713' .and. kd .le. '920726') go to 7171
	if (kd .ge. '930315' .and. kd .le. '930422') go to 7171
	if (kd .ge. '930518' .and. kd .le. '930611') go to 7171
	if (kd .ge. '931211' .and. kd .le. '940106') go to 7171
	if (kd .ge. '940308' .and. kd .le. '940509') go to 7171
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
C
CCCCCCCCCCCCCCCCCC
C
		DO 399 LN=1,3
C
			SMB1=0
			SMA1=0
			SMB2=0  	! get total wt bef. & aft. both halves
			SMA2=0
			DO 222 LL=1,7
				SMB1=SMB1+SCREEN(LL,IS,1,LN)
				SMA1=SMA1+SCREEN(LL+7,IS,1,LN)
				SMB2=SMB2+SCREEN(LL,IS,2,LN)
				SMA2=SMA2+SCREEN(LL+7,IS,2,LN)
222			CONTINUE
C
		IF (CAB(2,IS,LN) .GT. 0) THEN		!PELLET B/A STEP 2
		SX(6)=SX(6)+CAB(2,IS,LN)
		SX2(6)=SX2(6)+CAB(2,IS,LN)**2
		N(6)=N(6)+1
		END IF
C
		IF (SMB1 .LE. 0) GO TO 500
		X=(SCREEN(1,IS,1,LN)+SCREEN(2,IS,1,LN))/SMB1*100.
C
		IF (X .GT. 0) THEN			!  +1/2  STEP 2
		SX(7)=SX(7)+X
		SX2(7)=SX2(7)+X**2
		N(7)=N(7)+1
		END IF
C
500		IF (SMB2 .LE. 0) GO TO 501
		X=(SCREEN(1,IS,2,LN)+SCREEN(2,IS,2,LN))/SMB2*100.
C
		IF (X .GT. 0) THEN			!  +1/2  STEP 2
		SX(7)=SX(7)+X
		SX2(7)=SX2(7)+X**2
		N(7)=N(7)+1
		END IF
C
501	IF (SMB1 .LE. 0) GO TO 502
	X=(SCREEN(1,IS,1,LN)+SCREEN(2,IS,1,LN)+SCREEN(3,IS,1,LN)+
	1			SCREEN(4,IS,1,LN))/SMB1*100
C
		IF (X .GT. 0) THEN			!  BT1/4  STEP 2
		SX(8)=SX(8)+X
		SX2(8)=SX2(8)+X**2
		N(8)=N(8)+1
		END IF
C
502	IF (SMB2 .LE. 0) GO TO 503
	X=(SCREEN(1,IS,2,LN)+SCREEN(2,IS,2,LN)+SCREEN(3,IS,2,LN)+
	1			SCREEN(4,IS,2,LN))/SMB2*100.
C
		IF (X .GT. 0) THEN			!  BT1/4  STEP 2
		SX(8)=SX(8)+X
		SX2(8)=SX2(8)+X**2
		N(8)=N(8)+1
		END IF
C
C
503	IF (SMA1 .LE. 0) GO TO 504
	X=(SCREEN(8,IS,1,LN)+SCREEN(9,IS,1,LN)+SCREEN(10,IS,1,LN)+
	1			SCREEN(11,IS,1,LN))/SMA1*100.
C
		IF (X .GT. 0) THEN			!  AT1/4  STEP 2
		SX(9)=SX(9)+X
		SX2(9)=SX2(9)+X**2
		N(9)=N(9)+1
		END IF
C
504	IF (SMA2 .LE. 0) GO TO 505
	X=(SCREEN(8,IS,2,LN)+SCREEN(9,IS,2,LN)+SCREEN(10,IS,2,LN)+
	1			SCREEN(11,IS,2,LN))/SMA2*100.
C
		IF (X .GT. 0) THEN			!  AT1/4  STEP 2
		SX(9)=SX(9)+X
		SX2(9)=SX2(9)+X**2
		N(9)=N(9)+1
		END IF
C
505		X=COMP(1,IS,1,LN) 		!COMPRESSION
C
		IF (X .GT. 0) THEN
			SX(10)=SX(10)+X
			SX2(10)=SX2(10)+X**2
			N(10)=N(10)+1
		END IF
C
		X=COMP(1,IS,2,LN)
C
		IF (X .GT. 0) THEN
			SX(10)=SX(10)+X
			SX2(10)=SX2(10)+X**2
			N(10)=N(10)+1
		END IF
C
C
C
C
399		CONTINUE
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCC
C
C		IGNORE STEP 3 ACID DATA
C
7171	if (kd .ge. '930901' .and. kd .le. '930927') go to 400
	if (kd .ge. '931012' .and. kd .le. '931208') go to 400
c
		DO 398 LN=4,5
C
C
C
CCCCCCCCCCC
			SMB1=0
			SMA1=0
			SMB2=0  	! get total wt bef. & aft. both halves
			SMA2=0
			DO 5222 LL=1,7
				SMB1=SMB1+SCREEN(LL,IS,1,LN)
				SMA1=SMA1+SCREEN(LL+7,IS,1,LN)
				SMB2=SMB2+SCREEN(LL,IS,2,LN)
				SMA2=SMA2+SCREEN(LL+7,IS,2,LN)
5222			CONTINUE
C
CCCCCCCCCCC
C
C
C
		IF (CAB(2,IS,LN) .GT. 0) THEN		!PELLET B/A STEP 3
		SX(14)=SX(14)+CAB(2,IS,LN)
		SX2(14)=SX2(14)+CAB(2,IS,LN)**2
		N(14)=N(14)+1
		END IF
C
		IF (SMB1 .LE. 0) GO TO 506
		X=(SCREEN(1,IS,1,LN)+SCREEN(2,IS,1,LN))/SMB1*100.
C
		IF (X .GT. 0) THEN			!  +1/2  STEP 3
		SX(15)=SX(15)+X
		SX2(15)=SX2(15)+X**2
		N(15)=N(15)+1
		END IF
C
506		IF (SMB2 .LE. 0) GO TO 507
		X=(SCREEN(1,IS,2,LN)+SCREEN(2,IS,2,LN))/SMB2*100.
C
		IF (X .GT. 0) THEN			!  +1/2  STEP 3
		SX(15)=SX(15)+X
		SX2(15)=SX2(15)+X**2
		N(15)=N(15)+1
		END IF
C
507		IF (SMB1 .LE. 0) GO TO 508
	X=(SCREEN(1,IS,1,LN)+SCREEN(2,IS,1,LN)+SCREEN(3,IS,1,LN)+
	1			SCREEN(4,IS,1,LN))/SMB1*100.
C
		IF (X .GT. 0) THEN			!  BT1/4  STEP 3
		SX(16)=SX(16)+X
		SX2(16)=SX2(16)+X**2
		N(16)=N(16)+1
		END IF
C
508		IF (SMB2 .LE. 0) GO TO 509
	X=(SCREEN(1,IS,2,LN)+SCREEN(2,IS,2,LN)+SCREEN(3,IS,2,LN)+
	1			SCREEN(4,IS,2,LN))/SMB2*100.
C
		IF (X .GT. 0) THEN			!  BT1/4  STEP 3
		SX(16)=SX(16)+X
		SX2(16)=SX2(16)+X**2
		N(16)=N(16)+1
		END IF
C
C
509		IF (SMA1 .LE. 0) GO TO 510
	X=(SCREEN(8,IS,1,LN)+SCREEN(9,IS,1,LN)+SCREEN(10,IS,1,LN)+
	1			SCREEN(11,IS,1,LN))/SMA1*100.
C
		IF (X .GT. 0) THEN			!  AT1/4  STEP 3
		SX(17)=SX(17)+X
		SX2(17)=SX2(17)+X**2
		N(17)=N(17)+1
		END IF
C
510		IF (SMA2 .LE. 0) GO TO 511
	X=(SCREEN(8,IS,2,LN)+SCREEN(9,IS,2,LN)+SCREEN(10,IS,2,LN)+
	1			SCREEN(11,IS,2,LN))/SMA2*100.
C
		IF (X .GT. 0) THEN			!  AT1/4  STEP 3
		SX(17)=SX(17)+X
		SX2(17)=SX2(17)+X**2
		N(17)=N(17)+1
		END IF
C
511		X=COMP(1,IS,1,LN) 		!COMPRESSION
C
		IF (X .GT. 0) THEN
			SX(18)=SX(18)+X
			SX2(18)=SX2(18)+X**2
			N(18)=N(18)+1
		END IF
C
		X=COMP(1,IS,2,LN)
C
		IF (X .GT. 0) THEN
			SX(18)=SX(18)+X
			SX2(18)=SX2(18)+X**2
			N(18)=N(18)+1
		END IF
C
C
C
C
398		CONTINUE
C
C
C
400	CONTINUE
C
C
C
	GO TO 111
C
C
C
c
c
cccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c		GET WEEKLY LTB'S BY STEP
C
C	go thru met files a day at a time until all are found
c
C
200	FILE='01-JAN-'//YR
C
445	OPEN (25,FILE='USER_D:[METREP.AMBF]AMB'//FILE(1:11)//'.DAT',
	1	ERR=2525,
	1	STATUS='OLD',SHARED,USEROPEN=UFO_OPEN,FORM='UNFORMATTED')
	OPEN (26,FILE='USER_D:[METREP.BMHF]BMH'//FILE(1:11)//'.DAT',
	1	ERR=2525,
	1	STATUS='OLD',SHARED,USEROPEN=UFO_OPEN,FORM='UNFORMATTED')
C
	READ (25,ERR=2525) MCC,OIC,NM,NY
	READ (26,ERR=2525) MCC3,OIC3,NM3,NY3
C
	CLOSE(25)
	CLOSE(26)
C
C
C
C	LTB
C
C
C
C
	XX=0
	JJ=0
	DO 455 I=125,127
		IF (OIC(I) .GT. 0) THEN
			XX=XX+OIC(I)
			JJ=JJ+1
		END IF
455	CONTINUE
C
	IF (JJ .EQ. 0) GO TO 460
C
	XX=XX/JJ
C
	SX(11)=SX(11)+XX
	SX2(11)=SX2(11)+XX**2
	N(11)=N(11)+1
C
C
C
460	XX=0
	JJ=0
	DO 4155 I=105,106
		IF (OIC3(I) .GT. 0) THEN
			XX=XX+OIC3(I)
			JJ=JJ+1
		END IF
4155	CONTINUE
C
	IF (JJ .EQ. 0) GO TO 461
C
	XX=XX/JJ
C
	SX(19)=SX(19)+XX
	SX2(19)=SX2(19)+XX**2
	N(19)=N(19)+1
C
C
CCCCCCCCCC
C
C	REDUCIBILITY
C
C
461	XX=0
	JJ=0
	DO 55 I=128,130
		IF (OIC(I) .GT. 0) THEN
			XX=XX+OIC(I)
			JJ=JJ+1
		END IF
55	CONTINUE
C
	IF (JJ .EQ. 0) GO TO 60
C
	XX=XX/JJ
C
	SX(22)=SX(22)+XX
	SX2(22)=SX2(22)+XX**2
	N(22)=N(22)+1
C
C
C
60	XX=0
	JJ=0
	DO 155 I=107,108
		IF (OIC3(I) .GT. 0) THEN
			XX=XX+OIC3(I)
			JJ=JJ+1
		END IF
155	CONTINUE
C
	IF (JJ .EQ. 0) GO TO 61
C
	XX=XX/JJ
C
	SX(23)=SX(23)+XX
	SX2(23)=SX2(23)+XX**2
	N(23)=N(23)+1
C
C
C
CCCCCCCCCC
61	CALL SYS$BINTIM (FILE,ENDB)
	CALL LIB$ADD_TIMES (ENDB,DAYB,ENDB)
	CALL SYS$ASCTIM (,FILE,ENDB,)
	IF (FILE(1:1) .EQ. ' ') FILE(1:1)='0'
	if (enda(1:11) .eq. file(1:11)) go to 7224
	GO TO 445
C
CC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C		NOLA VS. TARGET DATA
C
7224		DO 556 I=1,12
			IF (MON(I) .EQ. ENDA(4:6)) GO TO 557
556		CONTINUE
		STOP ' DATE ERROR'
557		WRITE (EK(4:5),'(I2)') I
		IF (EK(4:4) .EQ. ' ') EK(4:4)='0'
		EK='2'//ENDA(10:11)//EK(4:5)//ENDA(1:2)
C
809	OPEN (UNIT=21,FILE='DISK0:[METREP.GKS]SAVNOLTAR.DAT',
	1	STATUS='UNKNOWN',FORM='UNFORMATTED',ORGANIZATION='INDEXED',
	1	ACCESS='KEYED',RECL=1024,
	1	KEY=(1:7:CHARACTER),IOSTAT=MX,SHARED,READONLY)
C
	NTK(1:1)='2'
C
	READ (21,KEYGE=NTK) NOL
C
	GO TO 722
C
46	READ (21,IOSTAT=M5) NOL
C
	IF (M5 .EQ. 51) THEN
		CALL LIB$WAIT(.2)
		GO TO 46
	END IF
C
C
C
722	IF (NOL.KEY .GE. EK) GO TO 553	! DONE
C
C
C
	DO 282 J=1,50
C
		X=0
		DO 272 M=1,4
		IF (NOL.POINTS(M,J).LE.0 .OR. NOL.TARG(M,J).LE.0) GO TO 272
		X=X+(NOL.POINTS(M,J)-NOL.TARG(M,J))
272		CONTINUE
C
		IF (X .EQ. 0) GO TO 282
		X=X/M
C
C
		SX(4)=SX(4)+X
		SX2(4)=SX2(4)+X**2
		N(4)=N(4)+1
C
282	CONTINUE
C
	GO TO 46
C
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
C		STEP 3 NOL VS TARG
C
C
553	EK(1:1)='3'
	NTK(1:1)='3'
C
	READ (21,KEYGE=NTK) NOL
C
	GO TO 7226
C
466	READ (21,IOSTAT=M5) NOL
C
	IF (M5 .EQ. 51) THEN
		CALL LIB$WAIT(.2)
		GO TO 466
	END IF
C
C
7226	IF (NOL.KEY .GE. EK) GO TO 899	! DONE
C
C
C
	DO 2826 J=1,50
C
		X=0
		DO 2726 I=1,4
		IF (NOL.POINTS(I,J).LE.0 .OR. NOL.TARG(I,J).LE.0) GO TO 2726
		X=X+(NOL.POINTS(I,J)-NOL.TARG(I,J))
2726		CONTINUE
C
		IF (X .EQ. 0) GO TO 2826
		X=X/I
C
		SX(5)=SX(5)+X
		SX2(5)=SX2(5)+X**2
		N(5)=N(5)+1
C
2826	CONTINUE
C
	GO TO 466
C
899	CLOSE (21)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
C		TRAIN MOISTURE
C
C
C
C
C	area to get train data from wjb
	IF (LASTYEAR .EQ. 1) THEN
C
	OPEN (65,FILE='OREM:WBILL.RJM'//YR(3:4),ACCESS='DIRECT'
	1	,FORM='UNFORMATTED',
	1	SHARED,USEROPEN=UFO_OPEN,STATUS='OLD')
C
	READ (65,REC=1)FLUXL,FLUXH
	CLOSE (65)
C
	ELSE
C
	OPEN (65,FILE='OREM:WBILL.RJM',ACCESS='DIRECT'
	1	,FORM='UNFORMATTED',
	1	SHARED,USEROPEN=UFO_OPEN,STATUS='OLD')
C
	READ (65,REC=1)FLUXL,FLUXH
	CLOSE (65)
C
C
	END IF
C
C
C
	IF (LASTYEAR .EQ. 1) THEN
C
	OPEN (UNIT=66,FILE='OREM:TRAINS.RJM'//YR(3:4),
	1	STATUS='OLD',ACCESS='KEYED',
	1	READONLY)
C
	ELSE
C
	OPEN (UNIT=66,FILE='OREM:TRAINS.RJM',STATUS='OLD',ACCESS='KEYED',
	1	READONLY)
C
	END IF
C
	II=1
C
	READ(66,KEYGE=0)DATETIME,WBILL,PLANT,NUM,CARS,
	1	TONS,IRON,SILL,MOIST,PHOS,MN,ALUM,CAO,MGO,BA
	GO TO 4499
C
C
39	READ(66,err=900)DATETIME,WBILL,PLANT,NUM,CARS,
	1	TONS,IRON,SILL,MOIST,PHOS,MN,ALUM,CAO,MGO,BA
C
C
4499	IY=JIBITS(DATETIME,21,8)
	IM=JIBITS(DATETIME,17,4)
	ID=JIBITS(DATETIME,12,5)
	IY=IY+1900
C
	READ (YR,'(I4)') IIY
C
	IF (IY .LT. IIY) GO TO 39
	IF (IY .GT. IIY) GO TO 900
C
	IF (.NOT.(IM .GE. 1 .AND. IM .LE. MNTH)) GO TO 900
C
C
C	   check if wbill is an east or west FLUX train
c
		DO 45 MM=1,16
		IF (WBILL .GE. FLUXL(MM) .AND. WBILL .LE. FLUXH(MM)) THEN
			IH=12
cccccc			IF (MM .LE. 8) IH=20
			GO TO 478
		END IF
C
45		CONTINUE
C
		GO TO 39
C
C
C		check for summer months
C
C
478	IF (.NOT. (IM .GE. 4 .AND. IM .LE. 10)) IH=IH+1
C
C
C
	SX(IH)=SX(IH)+MOIST
	SX2(IH)=SX2(IH)+MOIST**2
	N(IH)=N(IH)+1
C
	IF (IH .LT. 14) THEN
		IF (IH .EQ. 12) THEN
			TTT(1)=TTT(1)+TONS
			TTTX(1)=TTTX(1)+TONS*MOIST
		ELSE
			TTT(2)=TTT(2)+TONS
			TTTX(2)=TTTX(2)+TONS*MOIST
		END IF
C
	ELSE
		IF (IH .EQ. 20) THEN
			TTT(3)=TTT(3)+TONS
			TTTX(3)=TTTX(3)+TONS*MOIST
		ELSE
			TTT(4)=TTT(4)+TONS
			TTTX(4)=TTTX(4)+TONS*MOIST
		END IF
C
	END IF
C
C
	GO TO 39
C
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C 	CALC STD. DEV
C
C
900	DO 77 I=1,23
		IF (N(I) .LE. 0) GO TO 77
C
		MEAN(I)=SX(I)/N(I)
		MEANU(I)=SX(I)/N(I)
C
77	CONTINUE
C
C
C		CALC. MEAN
C
C
	DO 409 I=1,23
		IF (N(I) .LE. 0) GO TO 409
C
	IF (  ((N(I)*SX2(I)-SX(I)**2)/(N(I)*(N(I)-1))) .LE.0) GO TO 409
C
		SD(I)=SQRT((N(I)*SX2(I)-SX(I)**2)/(N(I)*(N(I)-1)))
C
409	CONTINUE
C
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C		GET WTD AVGS FROM YEAR FILE FROM AMB AND BMH
C		FOR ALL OF THE AGGLOM DATA
C
	CALL SYS$BINTIM (ENDA,ENDB)
	CALL LIB$SUB_TIMES(ENDB,DAYB,ENDB)
	CALL SYS$ASCTIM (,ENDA,ENDB,)
C
	OPEN (50,FILE='USER_D:[METREP.AMBF]AMB'//ENDA//'.DAT',
	1	STATUS='OLD',SHARED,USEROPEN=UFO_OPEN,FORM='UNFORMATTED')
C
	OPEN (51,FILE='USER_D:[METREP.BMHF]BMH'//ENDA//'.DAT',
	1	STATUS='OLD',SHARED,USEROPEN=UFO_OPEN,FORM='UNFORMATTED')
C
C
	READ (50) MCC,OIC,NM,NY
	READ (51) MCC3,OIC3,NM3,NY3
C
	CLOSE (50)
	CLOSE (51)
C
	TOT2=NY(1)+NY(2)+NY(3)
	TOT3=NY3(1)+NY3(2)
C
	MEAN(6)=(NY(69)*NY(1)+NY(70)*NY(2)+NY(71)*NY(3))/TOT2
	MEAN(14)=(NY3(102)*NY3(1)+NY3(103)*NY3(2))/TOT3
C
	MEAN(7)=(NY(101)*NY(1)+NY(111)*NY(2)+NY(121)*NY(3))/TOT2
	MEAN(15)=(NY3(49)*NY3(1)+NY3(59)*NY3(2))/TOT3
C
	MEAN(8)=((NY(101)+NY(102)+NY(103))*NY(1)+
	1  (NY(111)+NY(112)+NY(113))*NY(2)+
	1  (NY(121)+NY(122)+NY(123))*NY(3))/TOT2
C
C
	MEAN(16)=((NY3(49)+NY3(50)+NY3(51))*NY3(1)+
	1  (NY3(59)+NY3(60)+NY3(61))*NY3(2))/TOT3
C
C
	MEAN(9)=((NY(106)+NY(107)+NY(108))*NY(1)+
	1  (NY(116)+NY(117)+NY(118))*NY(2)+
	1  (NY(126)+NY(127)+NY(128))*NY(3))/TOT2
C
C
	MEAN(17)=((NY3(54)+NY3(55)+NY3(56))*NY3(1)+
	1  (NY3(64)+NY3(65)+NY3(66))*NY3(2))/TOT3
C
C
	MEAN(10)=(NY(131)*NY(1)+NY(132)*NY(2)+NY(133)*NY(3))/TOT2
	MEAN(18)=(NY3(69)*NY3(1)+NY3(70)*NY3(2))/TOT3
C
C
	OPEN (52,FILE='USER_D:[METREP.AMCN]AMI'//ENDA//'.DAT',
	1	STATUS='OLD',SHARED,USEROPEN=UFO_OPEN,FORM='UNFORMATTED')
C
C
	READ (52) MCC,OIC,NM,NY
C
	CLOSE (52)
C
	MEAN(2)=NY(186)
	MEAN(3)=NY(189)
C
	IF (TTT(1) .LE. 0) GO TO 713
	MEAN(12)=TTTX(1)/TTT(1)
713	IF (TTT(2) .LE. 0) GO TO 714
	MEAN(13)=TTTX(2)/TTT(2)
714	IF (TTT(3) .LE. 0) GO TO 715
	MEAN(20)=TTTX(3)/TTT(3)     
715	IF (TTT(4) .LE. 0) GO TO 716
	MEAN(21)=TTTX(4)/TTT(4)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
716	WRITE (6,513) ENDA(8:11),ENDA
513	FORMAT ('1',20X,'MINNTAC IN-HOUSE STANDARDS'/' ',25X,
	1	'FLUXED PELLETS'/
	1'0',12X,'FROM  01-JAN-',A4,'  THRU  ',A11//
	1' ',34X,'MEAN',3X,'STD DEV',1X,'N-COUNT',3X,'ARITH. MEAN',
	12X,'INTERVAL'/)
C
	DO 474 I=12,13
C
ccc	IF (I .EQ. 12) THEN
C
cccc	 WRITE (6,514) LABEL(22),MEAN(22),SD(22),N(22),MEANU(22),INTV(22)
C
ccc	ELSE IF (I .EQ. 20 ) THEN
C
cccc	 WRITE (6,514) LABEL(23),MEAN(23),SD(23),N(23),MEANU(23),INTV(23)
C
cccc	END IF
C
		WRITE (6,514) LABEL(I),MEAN(I),SD(I),N(I),MEANU(I),INTV(I)
514	FORMAT (' ',A,4X,F10.2,F10.3,I6,3X,F10.2,3X,A)
C
474	CONTINUE
C
2525	WRITE (6,822)
822	FORMAT ('1'/'1')
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
		WRITE (6,229)STRL
	STOP
	END
