C
	PROGRAM	STRENDX
C
	IMPLICIT NONE
C
	INCLUDE	'($PRCDEF)'
C
	INTEGER*4	I,J,K,L,UFO_OPEN
C
	CHARACTER*23	DATETIME
	CHARACTER*12	DATEX/'            '/
	CHARACTER*12	DATX(100)
	CHARACTER*11	TRAINS/'OREM:TRAINS'/
C
	REAL*4		VALUES(24)
	REAL*4		VAL(24,100)
C
	EXTERNAL	UFO_OPEN
C
	OPEN	(UNIT=1,FILE='LOGS:STREND.DAT',STATUS='OLD',
	1	 ACCESS='DIRECT',RECORDTYPE='FIXED',
	1	 FORM='UNFORMATTED',RECL=27,SHARED,USEROPEN=UFO_OPEN)
C
	DO 100	I=1,100
		READ	(1,REC=I)DATX(I),(VAL(J,I),J=1,24)
100	CONTINUE
C
	CALL	LIB$DATE_TIME(DATETIME)	!GET TIME AND DATE
	DATEX(1:11)=DATETIME(1:11)
	IF (DATETIME(13:14) .EQ. '07')DATEX(12:12)='1'
	IF (DATETIME(13:14) .EQ. '14')DATEX(12:12)='2'
	IF (DATETIME(13:14) .EQ. '22')DATEX(12:12)='3'
	IF (DATEX(12:12) .EQ. ' ')GOTO 99999	!IF NOT END OF SHIFT QUIT
C
	IF (DATEX .EQ. DATX(1))GOTO 99999	!IF SHIFT ALREADY BUILT QUIT
C
	WRITE	(1,REC=1)DATEX,VALUES	!INSERT NEW SHIFT AT TOP OF FILE
C
	DO 200	I=1,99
		WRITE	(1,REC=I+1)DATX(I),(VAL(J,I),J=1,24)
200	CONTINUE
C
99999	CONTINUE
C
	CLOSE	(UNIT=1)
C
	CALL	SYS$CREPRC(,TRAINS,,,,,,TRAINS,%VAL(4),,,
	1	%VAL(PRC$M_DETACH.OR.PRC$M_NOACNT))
C
	CALL	EXIT
C
	END	

