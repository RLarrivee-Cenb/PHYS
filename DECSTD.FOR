C
	PROGRAM		DECSTD
C
C	THIS PROGRAM IS TURNED ON BY THE BMG TO VAX LINK AND
C	TAKES DATA OUT OF THE VAXLINK:DECSTD.LNK FILE AND MOVES IT
C	TO THE LOGS:STREND.DAT FILE EVERY SHIFT. THE BMG PROGRAM TRAINS
C	INITIATES THIS SEQUENCE.
C
	IMPLICIT NONE
C
	CHARACTER*12		DATEX
	CHARACTER*6		DATBMG
	CHARACTER*18		LFILE/'VAXLINK:DECSTD.LNK'/
C
	INTEGER*4		I,J,K,L
C
	REAL*4			BMG(2)
	REAL*4			VALU(24)
C
	EXTERNAL	UFO_OPEN
C
	OPEN	(UNIT=1,FILE='LOGS:STREND.DAT',STATUS='OLD',
	1	 ACCESS='DIRECT',RECORDTYPE='FIXED',
	1	 FORM='UNFORMATTED',RECL=27,SHARED,USEROPEN=UFO_OPEN)
C
	OPEN	(UNIT=2,FILE=LFILE,STATUS='OLD',
	1	 RECORDTYPE='FIXED',ACCESS='DIRECT',RECL=18,
	1	 FORM='FORMATTED',SHARED,USEROPEN=UFO_OPEN)
C
	DO 1000	I=1,9	!PROCESS NINE SHIFTS FROM BMG
C
	READ	(2,100,REC=I)DATBMG,BMG
100	FORMAT	(A,2F6.2)
C
	DO 800 J=1,100	!CHECK RECORDS IN STREND FILE
C
	READ	(1,REC=J)DATEX,VALU
C
	IF (DATEX(1:1) .EQ. ' ')DATEX(1:1)='0'
C
	IF (DATBMG(6:6) .NE. DATEX(12:12))GOTO 800	!CHECK SHIFT
	IF (DATBMG(3:4) .NE. DATEX(1:2))GOTO 800	!CHECK DAY
C
	VALU(16)=BMG(1)	!STEP 2 PELLET TRAINS
	VALU(17)=BMG(2)	!STEP 3 PELLET TRAINS
C
	WRITE	(1,REC=J)DATEX,VALU
C
800	CONTINUE
C
1000	CONTINUE
C
9999	CONTINUE
C
	CLOSE	(UNIT=1)
	CLOSE	(UNIT=2)
C
	CALL	EXIT
C
	END
