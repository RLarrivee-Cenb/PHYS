C
	PROGRAM	STRNDX
C
	IMPLICIT NONE
C
	INTEGER*4	I,J,K,L,M,N,PAGE,LEN
	INTEGER*4	BTIME(2),ETIME(2),RTIME(2)
	INTEGER*4	BDAYX,EDAYX,RDAYX
	INTEGER*4	UFO_OPEN,FLAG/64/
C
	REAL*4		VALU(24),CALC
C
	CHARACTER*12	DATEX
	CHARACTER*4	PRINTON/' [5i'/
	CHARACTER*4	PRINTOF/' [4i'/
	CHARACTER*1	FF
	CHARACTER*6	DAYX
	CHARACTER*12	BDATEX,EDATEX
C
	EXTERNAL	UFO_OPEN
C
	PRINTON(1:1)=CHAR(27)
	PRINTOF(1:1)=CHAR(27)
	FF=CHAR(12)
	DAYX='      '
C
	OPEN	(UNIT=6,FILE='SYS$COMMAND',STATUS='UNKNOWN')
C
5	CONTINUE
C
	WRITE	(6,10)
10	FORMAT	(' PLEASE TYPE STARTING DATE DD-MMM-YYYY'/,
	1	 ' EXAMPLE 10-NOV-1990... OR <RETURN> TO QUIT')
C
	READ	(6,15)LEN,BDATEX
15	FORMAT	(Q,A)
C
	IF (LEN .EQ. 0)GOTO 9999	!IF RETURN KEY THEN SHUT OFF
C
	WRITE	(6,20)
20	FORMAT	(' PLEASE TYPE ENDING DATE DD-MMM-YYYY'/,
	1	 ' EXAMPLE 29-NOV-1990... OR <RETURN> TO QUIT')
C
	READ	(6,25)LEN,EDATEX
25	FORMAT	(Q,A)
C
	IF (LEN .EQ. 0)GOTO 9999	!IF RETURN KEY THEN SHUT OFF
C
	CALL	SYS$BINTIM(BDATEX,BTIME)
	CALL	SYS$BINTIM(EDATEX,ETIME)
	CALL	LIB$DAY(BDAYX,BTIME)	!DAYS SINCE BEGINNING DATE
	CALL	LIB$DAY(EDAYX,ETIME)	!DAYS SINCE ENDING DATE
C
	CALL	LIB$SPAWN('SET TERM/WIDTH=132',,,FLAG)
	CALL	LIB$SPAWN(' SET TERM/FORM',,,FLAG)
	WRITE	(6,45)PRINTON
45	FORMAT	(' ',A)
C
	OPEN	(UNIT=1,FILE='LOGS:STREND.DAT',STATUS='OLD',
	1	 ACCESS='DIRECT',RECORDTYPE='FIXED',
	1	 FORM='UNFORMATTED',RECL=27,SHARED,USEROPEN=UFO_OPEN)
C
	I=0	!RECORD INDEX
	PAGE=56
C
150	CONTINUE
C
	I=I+1
C
	READ	(UNIT=1,REC=I,ERR=99999)DATEX,VALU
C
	CALL	SYS$BINTIM(DATEX(1:11),RTIME)
	CALL	LIB$DAY(RDAYX,RTIME)
C
	IF (RDAYX .LT. BDAYX)GOTO 150	!DATE NOT GREATER THAN BEGINNING DATE
	IF (RDAYX .GT. EDAYX)GOTO 150	!DATE GREATER THAN ENDING DATE
C

		CALC=VALU(12)-VALU(15)
C
		IF (DAYX .NE. DATEX(1:6))THEN
			PAGE=PAGE+1
			WRITE	(6,200)
200			FORMAT	(' ')
			DAYX=DATEX(1:6)
		END IF
C
	IF (PAGE .GE. 57)THEN
C
	WRITE	(6,100)FF,BDATEX,EDATEX
100	FORMAT	(' ',A,'OPERATIONS SILICA REPORT',53X,'STEP 1/2',25X,
	1	 'STEP 3'/,' ',A,2X,'TO',2X,A/,
	1	 ' ',10X,'MINE  CRUDE  IND',4X,'FLF   FLF AMINE',
	1	 3X,'FLF FL.TLS  FLF',4X,'NOLA  NOLA  FILT  LINE  PELL',4X,
	1	 'NOLA  NOLA  FILT  LINE  PELL'/,' ','DATE',6X,'SI/2',
	1	 4X,'S3   TOT',3X,'SIO2 -270M LBS/T DTREC  SIO2   -DT',4X,
	1	 'TARG  COMP  CAKE  PELL  TRNS',4X,'TARG  COMP  CAKE',2X,
	1	 'PELL  TRNS'/)
C
	PAGE=0
C
	END IF
C
		WRITE	(6,300)DATEX(1:6),DATEX(12:12),VALU(1),VALU(2),VALU(3),
	1		VALU(12),VALU(13),VALU(18),VALU(14),VALU(19),CALC,
	1		VALU(4),VALU(5),VALU(9),VALU(8),VALU(16),VALU(6),
	1		VALU(7),VALU(11),VALU(10),VALU(17)
300		FORMAT	(' ',A,1X,A,3F6.2,1X,2F6.2,F6.3,3F6.2,2X,5F6.2,
	1		2X,5F6.2)
C
	PAGE=PAGE+1
	GOTO 150	!GO READ ANOTHER RECORD
C
99999	CONTINUE
C
	WRITE	(6,45)PRINTOF
	CALL	LIB$SPAWN('SET TERM/WIDTH=80',,,FLAG)
	CALL	LIB$SPAWN('SET TERM/NOFORM',,,FLAG)
C
	CLOSE	(UNIT=1)
C
9999	CONTINUE
C
	CLOSE	(UNIT=6)
C
	CALL	EXIT
C
	END
