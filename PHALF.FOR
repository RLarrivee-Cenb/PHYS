CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
C		SHIFTGET.FOR
C
C		RJM 30-JAN-1990
C
C
C	LINK SHIFTGET,D_I:AGD/OPT,USER_D:[METREP.LINEAT]CONC_ANVAL/OPT
C
C
C	HEY BOB!  REMEMBER THAT BOTH THIS PROGRAM AND 'AUTOSTART' HAVE
C	TO BE START FROM THE SAME PROCESS OR SYS$WAKE WILL NOT WORK!!!
C
C	03-APR-92  added code to write shift mine indicated sio2 to the
C	file 'HALFSIL.DAT'.
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	
	IMPLICIT INTEGER (A-Z)      
C
	EXTERNAL UFO_OPEN
C
	INCLUDE '($PRCDEF)'
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
	CHARACTER ADATE*11,HSKEY*4,DATEX*12,ASCSH
C
C
C

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
	INTEGER BTIM(2)
C
	CHARACTER MHR*2,MINIT*2,TT*7,DAY1*1/'1'/,TTIME*16,ASHIFT*4,SINP,
	1	DATTIM*23,ATIM*11,KD*6
C
C
	REAL PA,PC,PM
C
	INTEGER DATF(2),IS,IH
C
C
C
C
	CHARACTER DX*12,AJ
C
	REAL A,B
C
	DOUBLE PRECISION X(91),VL(200) 
C
	INTEGER PTRH(30),BD(2),RTIM(2),INTV(2),YSTRDAY(2)
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
	CHARACTER TIMBUF*23
C
C
C
	CHARACTER ASTIM*14 /'-- 06:34:00.00'/, AINTV*7 /'0 08:00'/,
	1	FN*21 /'USER_D:[METREP]AMBMCC'/,  DAT*4/'.DAT'/,
	1       AD*23, FNM*33, AYSTR*23 ,FNDSTRNG*33
C
	REAL ANVAL(1200),MBTUS(5),ANVALC(1900),mm(3)
	INTEGER CXSTS(100),DATP(2)
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
c
	structure /bozo2/
c
		character*4	key		! yymm	(primary key)
		real		msil(3,31)	! mine ind. sio2 by shift,day
		real		cr12(3,31)	! crusher +1/2 by shift,day
		real 		flfr(3,31)	! flf davis tube recovery
		real		flfs(3,31)	! flf davis tube sio2
		real		fls(3,31)	! flf sio2
		real		flts(3,31)	! flot tails sio2
		real		aeff(4,3,31)	! amine efficiency by cell
c
c
	end structure
c
	record /bozo2/ hsd
c
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	GET MINE INDICATED SI02 FROM WJB EVERY SHIFT
C
C
	OPEN (UNIT=91,FILE='MET_P:HALFSIL2.DAT',STATUS='OLD',
	1	ACCESS='KEYED',SHARED,ERR=800)
C
C
	hskey(1:2)='92'
c
c
	WRITE (6,*) ' ENTER STARTING MONTH'
	read (5,88)lm
88	format (bn,i)
c
c
	ld=1
c
c
c
c
	do 1000 im=LM,lm
C
c
c
c
c
c
c
	write (hskey(3:4),'(i2)') im
	if (hskey(3:3) .eq. ' ') hskey(3:3)='0'

CCCCC
	LLC=0
C
333	READ (91,KEY=HSKEY,IOSTAT=M) HSD
C
C
C
	if (m .ne. 0) go to 1000
C
C
C
C
CCCCCCCCCCCCCCC
C
C
	do 999 j=LD,31
c
C
CCCCCCCCCCCCCCC
C
	if (im .eq. 2) then
		if (j .gt. 29) go to 1000
	ELSE IF (IM .EQ. 4) THEN
		IF (J .GT. 30) GO TO 1000
	end if
C
C
C
C
c
	HSD.KEY=HSKEY			! YYMM
C
	write (6,55)j,
	1 HSD.MSIL(1,J),HSD.MSIL(2,J),HSD.MSIL(3,J),
	1 HSD.CR12(1,J),HSD.CR12(2,J),HSD.CR12(3,J),
	1 HSD.FLFR(1,J),HSD.FLFR(2,J),HSD.FLFR(3,J),
	1 HSD.FLFS(1,J),HSD.FLFS(2,J),HSD.FLFS(3,J),
	1 HSD.FLS(1,J),HSD.FLS(2,J),HSD.FLS(3,J),
	1 HSD.FLTS(1,J),HSD.FLTS(2,J),HSD.FLTS(3,J),
	1 HSD.AEFF(1,1,J),HSD.AEFF(2,1,J),HSD.AEFF(3,1,J),HSD.AEFF(4,1,J),
	1 HSD.AEFF(1,2,J),HSD.AEFF(2,2,J),HSD.AEFF(3,2,J),HSD.AEFF(4,2,J),
	1 HSD.AEFF(1,3,J),HSD.AEFF(2,3,J),HSD.AEFF(3,3,J),HSD.AEFF(4,3,J)
c
55	format (' ',i2,/' ',3f8.2,'    MINE IND. SIL'/,
	1	3f8.2,'    CRUSHER +1/2 '/,
	1	3f8.2,'    FLF DT RECOV '/,
	1	3f8.2,'    FLF DT SIO2  '/,
	1	3f8.2,'    FLF SIO2     '/,
	1	3f8.2,'    FLOT TAIL SIL'/,'   AMINE EFFICIENCIES'/,
	1	' ',3(4F8.2/))
C
C
999	CONTINUE
c

C
C
C
1000	CONTINUE
C
C
	close (91)
C
800	STOP
	END
