CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
C		TRL               
C                              
C		               
C               
C
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	
C
	INTEGER UFO_OPEN
	EXTERNAL UFO_OPEN
C
	INCLUDE '($PRCDEF)'
	INCLUDE 'FMS$EXAMPLES:FDVDEF'
C
	INTEGER  WORKSPACE( 3 ),	!General workspace
	1	 CHECKWKSP( 3 ),	!Check workspace
	2	 TCA( 3 )		!Terminal Control Area
C
	CHARACTER LABEL(8)*30/
	1	'FLOT FEED DAVIS TUBE RECOVERY ',
	1	'FLOT FEED DAVIS TUBE SIL DIFF ',
	1	'FLOT TAILS IRON               ',
	1	'AMINE EFFICIENCY-BANK 1       ',
	1	'AMINE EFFICIENCY-BANK 2       ',
	1	'AMINE EFFICIENCY-BANK 3       ',
	1	'AMINE EFFICIENCY-BANK 4       ',
	1	'AMINE EFFICIENCY-TOTAL        '/
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
	CHARACTER HSKEY*4,AONE/'1'/
C
	INTEGER BTIM(2),BONE(2)
C
	CHARACTER TIMBUF*23
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
	structure /bozo2/
c
		character*4	key		! yymm	(primary key)
		real		msil(3,31)	! mine ind. sio2 by shift,day
		real		cr12(3,31)	! crusher +1/2 by shift,day
		real 		flfr(3,31)	! flf davis tube recovery
		real		flfs(3,31)	! flf davis tube sio2
		real		fls(3,31)	! flf sio2
		real		flts(3,31)	! flot tails sio2
		real		aeff(4,3,31)	! amine efficiency by cell
c
c
	end structure
c
	record /bozo2/ hsd
c
	STRUCTURE /BOB/
		UNION
			MAP
				CHARACTER INPUT*400
			END MAP
C
C
			MAP
				CHARACTER D7*7
				CHARACTER S1(6)*6
				CHARACTER S2(6)*6
				CHARACTER S3(6)*6
				CHARACTER AS1(4)*6
				CHARACTER AS2(4)*6
				CHARACTER AS3(4)*6
				CHARACTER REPLY
			END MAP
		END UNION
	END STRUCTURE
C
	RECORD /BOB/  INP
C
C
	CHARACTER MON(12)*3/'JAN','FEB','MAR','APR','MAY','JUN','JUL',
	1	'AUG','SEP','OCT','NOV','DEC'/
	CHARACTER ASC*11,ADAY*11
	INTEGER BDAY(2)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
	CALL SYS$BINTIM (AONE,BONE)
C
464	CALL FDV$ATERM( %DESCR(TCA),12 ,2)
	CALL FDV$AWKSP( %DESCR(WORKSPACE), 2000 )
	CALL FDV$LOPEN( 'DISK0:[METREP]FIXTOM', 1 )
C
	OPEN (UNIT=91,FILE='MET_P:HALFSIL2.DAT',STATUS='OLD',
	1	ACCESS='KEYED',SHARED)
C
	CALL FDV$CDISP ('FIXTOM')
C
2	CALL FDV$GET (ASC,II,'DATE')
	IF (ASC(1:1) .EQ. ' ') ASC(1:1)='0'
C
C
	ADAY=ASC(1:2)//'-'//ASC(3:5)//'-19'//ASC(6:7)
C
100	CALL SYS$BINTIM (ADAY,BDAY)
C
C
	DO 10 I=1,12
		IF (ASC(3:5) .EQ. MON(I)) GO TO 11
10	CONTINUE
	GO TO 2
C
11	WRITE (HSKEY(3:4),'(I2)') I
	IF (HSKEY(3:3) .EQ. ' ') HSKEY(3:3)='0'
C
	HSKEY=ASC(6:7)//HSKEY(3:4)
C
C
C
333	READ (91,KEY=HSKEY,IOSTAT=M) HSD
C
C
	READ (ASC(1:2),'(I2)') ID
C
	IF (ID .LT. 1 .OR. ID .GT. 31) THEN
	CALL FDV$PUTL ('DAY IS BAD')
	CALL FDV$WAIT
	GO TO 99
	END IF
C
C
C
	DO 20 I=1,3
C
		WRITE (ASC,'(F6.2)') HSD.MSIL(I,ID)
		CALL FDV$PUT (ASC,'MINE',I)
C
		WRITE (ASC,'(F6.2)') HSD.CR12(I,ID)
		CALL FDV$PUT (ASC,'CRUSH',I)
C
		WRITE (ASC,'(F6.2)') HSD.FLFR(I,ID)
		CALL FDV$PUT (ASC,'RECOV',I)
C
		WRITE (ASC,'(F6.2)') HSD.FLFS(I,ID)
		CALL FDV$PUT (ASC,'DTSIL',I)
C
		WRITE (ASC,'(F6.2)') HSD.FLS(I,ID)
		CALL FDV$PUT (ASC,'FEED',I)
C
		WRITE (ASC,'(F6.2)') HSD.FLTS(I,ID)
		CALL FDV$PUT (ASC,'TAIL',I)
C
C
C
20	CONTINUE
C
C
	DO 21 I=1,4
C
		WRITE (ASC,'(F6.2)') HSD.AEFF(I,1,ID)
		CALL FDV$PUT (ASC,'A1',I)
C
		WRITE (ASC,'(F6.2)') HSD.AEFF(I,2,ID)
		CALL FDV$PUT (ASC,'A2',I)
C
		WRITE (ASC,'(F6.2)') HSD.AEFF(I,3,ID)
		CALL FDV$PUT (ASC,'A3',I)
C
21	CONTINUE
C
C
	M3=FDV$GETAL (INP.INPUT,KK,'DATE',)
C
	IF (.NOT. (M3 .EQ. FDV$_MOD)) GO TO 80 
C
	READ (INP.S1(1),'(F6.2)') HSD.MSIL(1,ID)
	READ (INP.S1(2),'(F6.2)') HSD.CR12(1,ID)
	READ (INP.S1(3),'(F6.2)') HSD.FLFR(1,ID)
	READ (INP.S1(4),'(F6.2)') HSD.FLFS(1,ID)
	READ (INP.S1(5),'(F6.2)') HSD.FLS(1,ID) 
	READ (INP.S1(6),'(F6.2)') HSD.FLTS(1,ID)
C
	READ (INP.S2(1),'(F6.2)') HSD.MSIL(2,ID)
	READ (INP.S2(2),'(F6.2)') HSD.CR12(2,ID)
	READ (INP.S2(3),'(F6.2)') HSD.FLFR(2,ID)
	READ (INP.S2(4),'(F6.2)') HSD.FLFS(2,ID)
	READ (INP.S2(5),'(F6.2)') HSD.FLS(2,ID) 
	READ (INP.S2(6),'(F6.2)') HSD.FLTS(2,ID)
C
	READ (INP.S3(1),'(F6.2)') HSD.MSIL(3,ID)
	READ (INP.S3(2),'(F6.2)') HSD.CR12(3,ID)
	READ (INP.S3(3),'(F6.2)') HSD.FLFR(3,ID)
	READ (INP.S3(4),'(F6.2)') HSD.FLFS(3,ID)
	READ (INP.S3(5),'(F6.2)') HSD.FLS(3,ID) 
	READ (INP.S3(6),'(F6.2)') HSD.FLTS(3,ID)
C
C
C
	DO 60 J=1,4
	READ (INP.AS1(J),'(F6.2)') HSD.AEFF(J,1,ID)
	READ (INP.AS2(J),'(F6.2)') HSD.AEFF(J,2,ID)
	READ (INP.AS3(J),'(F6.2)') HSD.AEFF(J,3,ID)
60	CONTINUE
C
C
C
	rewrite (91) HSD
C
	IF (INP.REPLY .EQ. 'A' .OR. INP.REPLY .EQ. 'a')GO TO 99
C
C
80	CALL LIB$ADD_TIMES(BDAY,BONE,BDAY)
	CALL SYS$ASCTIM (,ADAY,BDAY,)
	IF (ADAY(1:1) .EQ. ' ') ADAY(1:1)='0'
	CALL FDV$PUT (ADAY(1:2)//ADAY(4:6)//ADAY(10:11),'DATE')
	ASC=ADAY(1:2)//ADAY(4:6)//ADAY(10:11)
	GO TO 100
C
C
C
C
99	CALL FDV$LCLOS
	CALL FDV$SPADA (0)
CCC	CALL FDV$DEL ('FIXTOM')
CCC	CALL FDV$DWKSP (%DESCR(WORKSPACE))
	CALL FDV$DTERM(%DESCR(TCA))
C
	STOP
C
	END
